"use strict";(()=>{var e={};e.id=5758,e.ids=[5758],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{e.exports=require("punycode")},27910:e=>{e.exports=require("stream")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34631:e=>{e.exports=require("tls")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{e.exports=require("crypto")},55591:e=>{e.exports=require("https")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{e.exports=require("zlib")},79428:e=>{e.exports=require("buffer")},79551:e=>{e.exports=require("url")},81630:e=>{e.exports=require("http")},91645:e=>{e.exports=require("net")},94484:(e,r,t)=>{t.r(r),t.d(r,{patchFetch:()=>f,routeModule:()=>m,serverHooks:()=>v,workAsyncStorage:()=>h,workUnitAsyncStorage:()=>x});var n={};t.r(n),t.d(n,{GET:()=>c,POST:()=>g});var s=t(96559),o=t(48088),a=t(37719),i=t(32190),p=t(76033),l=t(61143),u=t(45697);let d=u.z.object({name:u.z.string().min(1,"Name is required"),email:u.z.string().email("Invalid email address"),phone:u.z.string().optional(),address:u.z.string().optional(),profilePhoto:u.z.string().optional(),department:u.z.string().min(1,"Department is required"),position:u.z.string().optional(),hireDate:u.z.string().optional(),status:u.z.enum(["Active","Inactive","On Leave","Suspended"]).default("Active"),biography:u.z.string().optional(),spouseName:u.z.string().optional(),spouseOccupation:u.z.string().optional(),childrenCount:u.z.string().optional(),emergencyContact:u.z.string().optional(),childrenNames:u.z.string().optional()});async function c(e){try{let r=await (0,p.U)(),{data:{user:t}}=await r.auth.getUser();if(!t)return i.NextResponse.json({error:"Unauthorized"},{status:401});let{searchParams:n}=new URL(e.url),s=parseInt(n.get("page")||"1"),o=parseInt(n.get("limit")||"10"),a=n.get("search")||"",u=n.get("department")||"",d=n.get("status")||"",c=n.get("sort")||"name_asc";console.log(`[API] GET /api/personnel - Page: ${s}, Limit: ${o}, Search: "${a}", Department: "${u}", Status: "${d}", Sort: "${c}"`);let g=await l.db.getAllPersonnel(s,o,{search:a||void 0,department:u||void 0,status:d||void 0,sort:c});return i.NextResponse.json({personnel:g.data,pagination:g.pagination})}catch(e){return console.error("[API] Error fetching personnel:",e),i.NextResponse.json({error:"Internal server error",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function g(e){try{let r=await (0,p.U)(),{data:{user:t}}=await r.auth.getUser();if(!t)return i.NextResponse.json({error:"Unauthorized"},{status:401});let n=await e.json(),s=d.parse(n);if(await l.db.findPersonnelByEmail(s.email))return i.NextResponse.json({error:"Personnel with this email already exists"},{status:400});let o=await l.db.createPersonnel({name:s.name,email:s.email,phone:s.phone||null,address:s.address||null,profile_photo:s.profilePhoto||null,department:s.department,position:s.position||null,hire_date:s.hireDate||null,status:s.status,biography:s.biography||null,spouse_name:s.spouseName||null,spouse_occupation:s.spouseOccupation||null,children_count:s.childrenCount||null,emergency_contact:s.emergencyContact||null,children_names:s.childrenNames||null});return i.NextResponse.json(o,{status:201})}catch(e){if(e instanceof u.z.ZodError)return i.NextResponse.json({error:"Validation error",details:e.errors},{status:400});return console.error("Error creating personnel:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}let m=new s.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/personnel/route",pathname:"/api/personnel",filename:"route",bundlePath:"app/api/personnel/route"},resolvedPagePath:"C:\\Users\\DABBIE\\OneDrive\\Desktop\\lgu-project-app\\src\\app\\api\\personnel\\route.ts",nextConfigOutput:"",userland:n}),{workAsyncStorage:h,workUnitAsyncStorage:x,serverHooks:v}=m;function f(){return(0,a.patchFetch)({workAsyncStorage:h,workUnitAsyncStorage:x})}},94735:e=>{e.exports=require("events")}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[4243,580,9398,3410,5697,217],()=>t(94484));module.exports=n})();